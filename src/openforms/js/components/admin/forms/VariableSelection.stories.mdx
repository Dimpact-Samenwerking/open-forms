import {ArgsTable, Canvas, Meta, Story} from '@storybook/addon-docs';
import {useArgs} from '@storybook/client-api';

import {FormContext} from 'components/admin/form_design/Context';
import {FormDecorator} from 'components/admin/form_design/story-decorators';

import VariableSelection from './VariableSelection';

<Meta
  title="Form design/VariableSelection"
  component={VariableSelection}
  decorators={[FormDecorator]}
  argTypes={{
    availableFormSteps: {table: {disable: true}},
    availableStaticVariables: {table: {disable: true}},
    availableFormVariables: {table: {disable: true}},
  }}
/>

# Variable selection dropdown

Select widget for form and static variables

export const Template = ({name, includeStaticVariables, onChange, filter}) => {
  const [{value}, updateArgs] = useArgs();
  return (
    <VariableSelection
      name={name}
      value={value}
      includeStaticVariables={includeStaticVariables}
      onChange={event => updateArgs({value: event.target.value})}
      filter={filter}
    />
  );
};

<Canvas>
  <Story
    name="Default"
    args={{
      name: 'variableSelection',
      value: 'key2',
      includeStaticVariables: true,
      onChange: () => null,
      filter: () => true,
      availableFormSteps: [
        {
          configuration: {display: 'form'},
          formDefinition: 'foo',
          slug: '',
          url: '',
          _generatedId: '',
          isNew: true,
          validationErrors: [],
        },
      ],
      availableStaticVariables: [
        {
          form: 'foo',
          formDefinition: 'foo',
          name: 'name1',
          key: 'key1',
        },
      ],
      availableFormVariables: [
        {
          form: 'bar',
          formDefinition: 'bar',
          name: 'name2',
          key: 'key2',
        },
      ],
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Props

<ArgsTable of={VariableSelection} />
